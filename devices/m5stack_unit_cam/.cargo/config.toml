[build]
target = "xtensa-esp32-espidf"

[target.xtensa-esp32-espidf]
linker = "ldproxy"
runner = "espflash flash --monitor"
rustflags = ["--cfg", "espidf_time64"]

[unstable]
build-std = ["std", "panic_abort"]

[env]
MCU = "esp32"
ESP_IDF_VERSION = "v5.1.6"
CRATE_CC_NO_DEFAULTS = "1"

# Restrict ESP-IDF components to what's needed for ESP-NOW image streaming.
# This avoids pulling unused components like MQTT during build.
ESP_IDF_COMPONENTS = "esp_wifi,esp_event,esp_netif,nvs_flash,driver,esp_timer,freertos,log,esp_system,esp_hw_support,hal,heap,esp_common,esp_rom,esp_phy,spi_flash,app_update,bootloader_support"
