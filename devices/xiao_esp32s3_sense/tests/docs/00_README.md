# ESP32-S3 テスト戦略ドキュメント

ESP32-S3実機を使わないユニットテスト手法の調査結果と推奨戦略

## 📚 ドキュメント一覧

### 1. [01_SUMMARY.md](./01_SUMMARY.md) ⭐スタートはここから
調査結果の要約とエグゼクティブサマリー
- 調査結果一覧（QEMU、ホストテスト、probe-rs）
- 推奨実装ロードマップ
- 次のアクション

### 2. [02_STRATEGY.md](./02_STRATEGY.md)
包括的なテスト戦略ドキュメント
- 6つのテスト戦略の比較
- 3層テストアプローチの詳細
- CI/CD統合案
- 実装プラン

### 3. [03_INVESTIGATION_REPORT.md](./03_INVESTIGATION_REPORT.md)
詳細な調査レポート
- QEMUエミュレータ調査結果（非推奨の理由）
- probe-rs + embedded-test 調査結果（推奨）
- 技術的課題と対策
- コスト・ベネフィット分析

### 4. [04_PROBE_RS_SETUP_GUIDE.md](./04_PROBE_RS_SETUP_GUIDE.md) ⭐実装ガイド
probe-rsの具体的なセットアップ手順
- ステップバイステップのインストール手順
- テストコード実装例
- トラブルシューティング
- ベストプラクティス

### 5. [05_PROBE_RS_README.md](./05_PROBE_RS_README.md)
embedded-testクレートの公式README（参考資料）

## 🎯 推奨テスト戦略（3層アプローチ）

```
┌─────────────────────────────────────────────┐
│ Layer 3: 手動実機テスト                    │
│  WiFi/ESP-NOW、カメラ、システム全体        │
│  優先度: 低                                 │
├─────────────────────────────────────────────┤
│ Layer 2: probe-rs実機テスト ⭐NEW          │
│  センサー、GPIO、ペリフェラル              │
│  優先度: 中                                 │
├─────────────────────────────────────────────┤
│ Layer 1: ホストユニットテスト              │
│  計算ロジック、データ変換、設定パース      │
│  優先度: 高                                 │
└─────────────────────────────────────────────┘
```

## 🚀 クイックスタート

### Phase 1: ホストユニットテストから開始（推奨）
```bash
# 1. ビジネスロジックを純粋関数として分離
# 2. テストモジュールを追加
# 3. cargo testで実行
cargo test --lib
```

### Phase 2: probe-rs実機テストの導入
```bash
# 1. ツールのインストール
cargo install probe-rs-tools --locked

# 2. セットアップガイドに従って設定
# 詳細: 04_PROBE_RS_SETUP_GUIDE.md

# 3. テストの実行
cargo test --test hardware_test
```

## ❌ 非推奨: QEMU Emulator

理由:
- ESP32-S3のWiFi/カメラ/ADCが非対応
- セットアップが複雑
- ROIが低い

詳細: `03_INVESTIGATION_REPORT.md`参照

## 📊 投資対効果（ROI）

| 手法 | ROI | 推奨度 |
|-----|-----|-------|
| ホストユニットテスト | ⭐⭐⭐⭐⭐ | 強く推奨 |
| probe-rs実機テスト | ⭐⭐⭐⭐☆ | 推奨 |
| QEMU | ⭐☆☆☆☆ | 非推奨 |

## 🛠️ 次のアクション

1. `01_SUMMARY.md`を読む
2. チームでテスト戦略について合意形成
3. Phase 1（ホストテスト）の実装開始
4. 必要に応じてPhase 2（probe-rs）を検討

## 📞 サポート

質問や問題がある場合:
1. 各ドキュメントの「トラブルシューティング」セクションを確認
2. `04_PROBE_RS_SETUP_GUIDE.md`のベストプラクティスを確認
3. GitHubのissueを確認

---

**調査期間**: 2024-10-19 〜 2024-11-02  
**最終更新**: 2024-11-02
